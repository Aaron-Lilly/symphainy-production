# Production Environment Configuration - Layer 2
# Environment-specific settings for production

# Environment
ENVIRONMENT=production

# ===================================================================
# DATABASE CONFIGURATION
# ===================================================================
# EC2 DEPLOYMENT (Current): Using localhost for Docker containers on same EC2 instance
# OPTION C MIGRATION: Override with environment variable:
#   DATABASE_HOST=your-supabase-host.supabase.co
DATABASE_HOST=${DATABASE_HOST:-localhost}
DATABASE_PORT=5432
DATABASE_NAME=symphainy_platform_prod
DATABASE_USER=postgres
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=30
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# ===================================================================
# REDIS CONFIGURATION
# ===================================================================
# Docker Deployment: Use container name for service discovery
# Override with environment variable if needed:
#   REDIS_HOST=your-redis-memorystore.googleapis.com
REDIS_HOST=symphainy-redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_MAX_CONNECTIONS=20
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# ===================================================================
# API SERVER CONFIGURATION
# ===================================================================
# EC2 DEPLOYMENT: Bind to 0.0.0.0:8000 (accessible from frontend and external)
# OPTION C: Same binding (accessible via domain/load balancer)
API_HOST=${API_HOST:-0.0.0.0}
API_PORT=${API_PORT:-8000}
API_DEBUG=false
API_RELOAD=false
API_WORKERS=4
API_TIMEOUT=300
API_TIMEOUT_KEEP_ALIVE=300
API_TIMEOUT_GRACEFUL_SHUTDOWN=30
API_LIMIT_CONCURRENCY=1000
API_LIMIT_MAX_REQUESTS=10000
API_BACKLOG=2048
API_CORS_ORIGINS=${FRONTEND_URL:-http://35.215.64.103:3000},http://localhost:3000
API_CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
API_CORS_HEADERS=Content-Type,Authorization

# Security Configuration
JWT_EXPIRATION=3600
JWT_ALGORITHM=HS256
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SYMBOLS=true

# LLM Configuration
LLM_PROVIDER_DEFAULT=openai
LLM_MODEL_DEFAULT=gpt-4
LLM_MAX_TOKENS=2000
LLM_TEMPERATURE=0.3
LLM_TOP_P=0.9
LLM_FREQUENCY_PENALTY=0.1
LLM_PRESENCE_PENALTY=0.1
LLM_TIMEOUT=120
LLM_RETRY_ATTEMPTS=3
LLM_RETRY_DELAY=2

# Multi-tenancy Configuration
MULTI_TENANT_ENABLED=true
DEFAULT_TENANT_TYPE=enterprise
MAX_TENANTS_PER_USER=10
TENANT_ISOLATION_STRICT=true
RLS_ENABLED=true

# Logging Configuration
LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s

# Health Monitoring Configuration
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=5
HEALTH_CHECK_RETRIES=3

# Background Task Intervals (Configurable)
NURSE_HEALTH_CHECK_INTERVAL=30
NURSE_POOL_MONITORING_INTERVAL=300
NURSE_LOG_MONITORING_INTERVAL=300
POST_OFFICE_HEARTBEAT_INTERVAL=60
CONDUCTOR_QUEUE_MONITORING_INTERVAL=45
SECURITY_GUARD_MONITORING_INTERVAL=120
CURATOR_AUTODISCOVERY_INTERVAL=300

# Governance Configuration
RATE_LIMITING_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=3600
COST_MANAGEMENT_ENABLED=true
MAX_DAILY_COST=100.0
AUDIT_LOGGING_ENABLED=true
AUDIT_RETENTION_DAYS=365

# Production-specific Settings
DEBUG_MODE=false
VERBOSE_LOGGING=false
HOT_RELOAD=false
PROFILING_ENABLED=true

# ===================================================================
# ARANGODB CONFIGURATION
# ===================================================================
# Docker Deployment: Use container name for service discovery
# ConfigAdapter.get_arangodb_config() uses ARANGO_URL (not ARANGO_HOSTS)
# Override with environment variable if needed:
#   ARANGO_URL=http://your-arango-oasis.arangodb.cloud:8529
ARANGO_URL=http://symphainy-arangodb:8529
ARANGO_USER=root
ARANGO_PASSWORD=
ARANGO_DATABASE=symphainy_platform

# ===================================================================
# CONSUL SERVICE DISCOVERY CONFIGURATION
# ===================================================================
# Docker Deployment: Use container name for service discovery
# Override with environment variable if needed:
#   CONSUL_HOST=your-consul-cluster.com
CONSUL_HOST=symphainy-consul
CONSUL_PORT=8500

# ===================================================================
# OPA (OPEN POLICY AGENT) CONFIGURATION
# ===================================================================
# Docker Deployment: Use container name for service discovery
# Override with environment variable if needed:
#   OPA_URL=https://your-managed-opa-service.com
OPA_URL=${OPA_URL:-http://symphainy-opa:8181}

# ===================================================================
# LOKI CONFIGURATION
# ===================================================================
# Docker Deployment: Use container name for service discovery
# Override with environment variable if needed:
#   LOKI_ENDPOINT=http://your-loki-service:3100
LOKI_ENDPOINT=${LOKI_ENDPOINT:-http://symphainy-loki:3100}
LOKI_TENANT_ID=${LOKI_TENANT_ID:-symphainy-platform}

# ===================================================================
# GCS (GOOGLE CLOUD STORAGE) CONFIGURATION
# ===================================================================
# GCS configuration follows Supabase pattern - project-specific values in .env.secrets
# Required in .env.secrets:
#   GCS_PROJECT_ID=your-gcp-project-id (project-specific, unique identifier)
#   GCS_BUCKET_NAME=your-gcs-bucket-name (project-specific, unique identifier)
#   GCS_CREDENTIALS_JSON={"type":"service_account",...} (secret credentials)
# 
# Pattern: Project-specific, unique identifiers go in secrets (like SUPABASE_URL)
#          Not because they're cryptographic secrets, but because they're project-specific
#          and shouldn't be shared publicly or committed to version control
